# Weekly CTF 1
These are from weekly meeting at the CTF club. Usually on picoCTF. 
First week is usually basic. 

## Inspector
[Inspector](https://play.picoctf.org/practice/challenge/18?category=1&page=2&search=)

For this challenge, we would need to inspect the HTML, CSS, JS files via Inspect.
On Element tab, part 1/3 of the flag would be in one of the div in the HTML. Click on it to expand it and you will see it in the comment.

Go to Source tab. In the CSS file, at the end of it, it is part 2/3 of the flag in comment.
In the JS file, at the end of it, it is part 3/3 of the flag.
Join them together to get the final flag.

# Where are the robots?
[Where are the robots](https://play.picoctf.org/practice/challenge/4?category=1&page=1&search=robot)

robot.txt is a text file to show which directories of the website bots are not allowed to visit.

Starting from the base URL (you can refresh the website to get to it), add "robots.txt" to the URL to see that file.
When you get there, you will see a "Disallowed: /477ce.html". This is the forbidden directory.

Go back to the base URL.

Add the new directory to the URL to go there and you will see the flag.

# SSTI1
[SSTI1](https://play.picoctf.org/practice/challenge/492?category=1&page=1&search=ssti)

From the look of this website, it seems to ask for an input and prints the input out into HTML.

There seems to be a XSS vulnerability as well. If you put in JS code with the javascript brackets, it will work
since there is no input sanitation.

From learning more about SSTI, I tried some common payloads like {{7*7}} and {{7*'7'}}, and it seems to be Jinja2 which is the template language for building this website. The first command prints 49 and second prints 7777777.

Further research on Jinja tells me that it is a template engine specifically for Python.

Updated 12/1/25: After going through some TryHackMe's rooms on the web vulnerabilities, I have learnt more about SSTI1.

It requires us to identify the template engine and use the appropriate payloads for it. We know that it is `Jinja2`. 

Here, I look up some common payloads (thanks to PayloadsAllTheThings at https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Python.md)

Then, I test a few of them for Jinja2 until I can run a command. Many may not work due to the version difference.

I came across this payload which works as seemingly intended:

`{{config.__class__.__init__.__globals__['os'].popen('ls').read()}}`

Then, I read up on `popen` so I use `popen('cat flag')` in place instead to get the flag.

It still requires reading the template engine documents.

Note: `().__class__.__mro__[1].__subclasses__()` for showing subclasses.
